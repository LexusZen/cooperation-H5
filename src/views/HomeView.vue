<template>
  <div class="home-container">
    <!-- ÂÖ®Â±ÄÈ°∂ÈÉ®‰ø°ÊÅØÊ†è -->
    <TopBar />

    <swiper
      :modules="modules"
      :direction="'vertical'"
      :slides-per-view="1"
      :space-between="0"
      :mousewheel="false"
      :allowTouchMove="false"
      :speed="400"
      :resistance="true"
      :resistance-ratio="0"
      :css-mode="false"
      :lazy="true"
      :preload-images="false"
      :pagination="{
        clickable: true,
        renderBullet: renderCustomBullet
      }"
      @swiper="onSwiperInit"
      @slide-change="onSlideChange"
      class="home-swiper"
      ref="swiperRef"
    >
      <swiper-slide class="slide-container">
        <div class="slide-content">
          <Section1 />
        </div>
      </swiper-slide>
      <swiper-slide class="slide-container">
        <div class="slide-content">
          <Section2 />
        </div>
      </swiper-slide>
      <swiper-slide class="slide-container">
        <div class="slide-content">
          <Section3 />
        </div>
      </swiper-slide>
      <swiper-slide class="slide-container">
        <div class="slide-content">
          <Section4 />
        </div>
      </swiper-slide>
      <swiper-slide class="slide-container">
        <div class="slide-content">
          <Section5 />
        </div>
      </swiper-slide>

      <swiper-slide class="slide-container">
        <div class="slide-content">
          <Section6 />
        </div>
      </swiper-slide>

      <!-- ÈááËÆøÊùøÂùó -->
      <swiper-slide class="slide-container">
        <div class="slide-content interview-wrapper">
          <swiper
            :modules="[Pagination]"
            :slides-per-view="1"
            :space-between="0"
            :pagination="{ clickable: true }"
            class="interview-swiper"
          >
            <swiper-slide v-for="person in interviewPeople" :key="person.id">
              <InterviewCard :person="person" />
            </swiper-slide>
          </swiper>
        </div>
      </swiper-slide>
    </swiper>
  </div>
</template>

<script setup lang="ts">
import { Swiper, SwiperSlide } from 'swiper/vue'
import { Pagination } from 'swiper/modules'
import type { InterviewPerson } from '@/types'
import { getImageUrl } from '@/utils/assets'

import Section1 from './Section1.vue'
import Section2 from './Section2.vue'
import Section3 from './Section3.vue'
import Section4 from './Section4.vue'
import Section5 from './Section5.vue'
import Section6 from './Section6.vue'
import InterviewCard from '@/components/InterviewCard.vue'
import TopBar from '@/components/TopBar.vue'

// Swiper 12+ ‰∏çÈúÄË¶ÅÂçïÁã¨ÂØºÂÖ•CSS

const modules = [Pagination]

// Ëá™ÂÆö‰πâÂàÜÈ°µÂô®ÂõæÊ†áÔºàÊ±ΩËΩ¶‰∏ªÈ¢òÔºâ
const sectionIcons = ['üöó', 'üèéÔ∏è', 'üöô', 'üöï', 'üöê', 'üí¨', 'üöÄ']

const renderCustomBullet = (index: number, className: string) => {
  return `<span class="${className}">
    <span class="bullet-icon">${sectionIcons[index]}</span>
  </span>`
}

const onSwiperInit = () => {
  // ÊùøÂùóÂàáÊç¢Áé∞Âú®ÂÆåÂÖ®ÈÄöËøáÁÇπÂáªÂàÜÈ°µÂô®Êù•ÂÆûÁé∞
}

const interviewPeople: InterviewPerson[] = [
  {
    id: 1,
    name: 'Âº†ÊÄª',
    role: 'Êñ∞ËÉΩÊ∫êÊ±ΩËΩ¶‰∫ß‰∏öÈìæ‰ºÅ‰∏öÂÆ∂',
    avatar: getImageUrl('/images/interview/avatar1.jpg'),
    quote: '‰∫ß‰∏öÂÖ®ÈìæÊù°ÈÉΩÊú¨Âú∞ÂåñÔºåÈ°πÁõÆÂΩìÂπ¥Âä®Â∑•ÂΩìÂπ¥Êäï‰∫ßÔºåÂú®ËøôÈáåÊäïËµÑÁúÅÊó∂ÁúÅÂäõÂèàÁúÅÂøÉ„ÄÇ'
  },
  {
    id: 2,
    name: 'ÊùéÈòøÂß®',
    role: 'Â§ßÂÆâÊùëÊùëÊ∞ë',
    avatar: getImageUrl('/images/interview/avatar2.jpg'),
    quote: '"ÁôæÂçÉ‰∏áÂ∑•Á®ã"ËÆ©Êàë‰ª¨ÊùëÂèò‰∫ÜÊ†∑ÔºÅ‰ª•ÂâçÊòØÂÆàÁùÄÁªøÊ∞¥ÈùíÂ±±ËøáÁ©∑Êó•Â≠êÔºåÁé∞Âú®Ë∑ØÈÄö‰∫Ü„ÄÅÁΩëÂø´‰∫Ü„ÄÅÁéØÂ¢ÉÁæé‰∫ÜÔºåÂÆ∂Èó®Âè£Â∞±ËÉΩÂ∞±‰∏öÂ¢ûÊî∂ÔºåËøôÊó•Â≠êÁúüÊúâÂ•îÂ§¥ÔºÅ'
  },
  {
    id: 3,
    name: 'ÁéãÂÖàÁîü',
    role: 'Êù•Ê∑±Âª∫ËÆæËÄÖ',
    avatar: getImageUrl('/images/interview/avatar3.jpg'),
    quote: 'ÊàëÈÄâÊã©Ê∑±Ê±ïÔºåÁúã‰∏≠ÁöÑÊòØËøôÈáåÁöÑÊú™Êù•ÊΩúÂäõ‰∏éÂÆúÂ±ÖÊú¨Ëâ≤„ÄÇËøôÈáåÊòØÂçäÂüéÂ±±Ê∞¥ÂçäÂüé‰∫ß‰∏öÔºåÊó¢ËÉΩËøΩÈÄêÊ¢¶ÊÉ≥Ôºå‰πüËÉΩÂÆâÊîæÁîüÊ¥ªÔºåÂÆåÁæéËØ†Èáä‰∫Ü‰ªÄ‰πàÊòØ"‰∫ßÂüéËûçÂêà"„ÄÇ'
  }
]

const onSlideChange = (swiper: any) => {
  console.log('ÂΩìÂâçÈ°µÈù¢:', swiper.activeIndex + 1)
}
</script>

<style scoped lang="scss">
.home-container {
  width: 100%;
  height: 100vh;
  overflow: hidden;
}

.home-swiper {
  width: 100%;
  height: 100%;

  :deep(.swiper-wrapper) {
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  }

  :deep(.swiper-slide) {
    will-change: transform;
    transform: translate3d(0, 0, 0);
    backface-visibility: hidden;

    // ÈùûÊøÄÊ¥ªÁöÑ slide Èôç‰ΩéÊ∏≤Êüì‰ºòÂÖàÁ∫ß
    &:not(.swiper-slide-active) {
      visibility: hidden;
      pointer-events: none;
    }

    &.swiper-slide-active,
    &.swiper-slide-next,
    &.swiper-slide-prev {
      visibility: visible;
      pointer-events: auto;
    }
  }
}

// ÊªëÂä®ÂÆπÂô®Ê†∑Âºè - ÂÖÅËÆ∏ÊØè‰∏™ÊùøÂùóÂÜÖÈÉ®ÊªöÂä®
.slide-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  transform: translate3d(0, 0, 0);
  will-change: transform;
  contain: layout style paint;
}

.slide-content {
  width: 100%;
  height: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  transform: translateZ(0);
  backface-visibility: hidden;
  contain: layout style;

  // ÈöêËóèÊªöÂä®Êù°‰ΩÜ‰øùÊåÅÊªöÂä®ÂäüËÉΩ
  scrollbar-width: none;
  -ms-overflow-style: none;

  &::-webkit-scrollbar {
    display: none;
  }
}

// Ë¶ÜÁõñ Swiper ÂûÇÁõ¥ÂàÜÈ°µÂô®ÈªòËÆ§Ê†∑Âºè - Âè™ÈíàÂØπ‰∏ªÂØºËà™
.home-swiper {
  :deep(.swiper-vertical > .swiper-pagination-bullets),
  :deep(.swiper-pagination-vertical.swiper-pagination-bullets) {
    top: auto !important;
    right: auto !important;
    bottom: 0 !important;
    left: 0 !important;
    transform: none !important;
    width: 100% !important;
  }

  // Ëá™ÂÆö‰πâ‰∏ªÂØºËà™ÂàÜÈ°µÂô®Ê†∑Âºè - Â∫ïÈÉ®Ê®™ÂêëÂ∏ÉÂ±ÄÔºåÂ∏¶ËÉåÊôØÂÆπÂô®
  > :deep(.swiper-pagination) {
    bottom: 0 !important;
    left: 0 !important;
    transform: none !important;
    width: 100% !important;
    top: auto !important;
    right: auto !important;
    display: flex;
    flex-direction: row;
    gap: 18px;
    justify-content: center;
    align-items: center;
    padding: 20px 0;
    background: linear-gradient(to top, rgba(173, 216, 230, 0.85), rgba(173, 216, 230, 0.75));
    backdrop-filter: blur(15px);
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);

    // Â∑¶Âè≥ÁïôÁôΩÊïàÊûú
    &::before,
    &::after {
      content: '';
      position: absolute;
      top: 0;
      bottom: 0;
      width: 20px;
      pointer-events: none;
    }

    &::before {
      left: 0;
      background: linear-gradient(to right, rgba(173, 216, 230, 0.85), transparent);
    }

    &::after {
      right: 0;
      background: linear-gradient(to left, rgba(173, 216, 230, 0.85), transparent);
    }

    .swiper-pagination-bullet {
      width: 42px;
      height: 42px;
      background: rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(10px);
      border-radius: 8px;
      opacity: 1;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid rgba(255, 255, 255, 0.5);
      margin: 0 !important;
      cursor: pointer;

      .bullet-icon {
        font-size: 20px;
        filter: grayscale(100%) opacity(0.6);
        transition: all 0.3s ease;
      }

      &:hover {
        transform: scale(1.1) translateY(-2px);
        background: rgba(255, 255, 255, 0.5);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);

        .bullet-icon {
          filter: grayscale(0%) opacity(1);
        }
      }

      &.swiper-pagination-bullet-active {
        width: 48px;
        height: 48px;
        background: rgba(229, 238, 255, 0.95);
        border-color: rgba(229, 238, 255, 1);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
        transform: translateY(-3px);

        .bullet-icon {
          font-size: 24px;
          filter: grayscale(0%) opacity(1);
          transform: scale(1.1);
        }
      }
    }

    // ÁßªÂä®Á´ØÂìçÂ∫îÂºè
    @media (max-width: 768px) {
      padding: 18px 0;
      gap: 14px;

      .swiper-pagination-bullet {
        width: 36px;
        height: 36px;
        border-width: 1.5px;
        border-radius: 6px;

        .bullet-icon {
          font-size: 17px;
        }

        &.swiper-pagination-bullet-active {
          width: 42px;
          height: 42px;

          .bullet-icon {
            font-size: 20px;
          }
        }
      }
    }

    // Â∞èÂ±èÊâãÊú∫
    @media (max-width: 480px) {
      padding: 15px 0;
      gap: 10px;

      .swiper-pagination-bullet {
        width: 32px;
        height: 32px;
        border-radius: 5px;

        .bullet-icon {
          font-size: 15px;
        }

        &.swiper-pagination-bullet-active {
          width: 36px;
          height: 36px;

          .bullet-icon {
            font-size: 17px;
          }
        }
      }
    }
  }
}

// ÈááËÆøÊùøÂùóÊ†∑Âºè
.interview-wrapper {
  padding: 0 !important;
  overflow: hidden;

  .interview-swiper {
    width: 100%;
    height: 100vh;

    :deep(.swiper-pagination) {
      bottom: 20px;

      .swiper-pagination-bullet {
        width: 10px;
        height: 10px;
        background: rgba(255, 255, 255, 0.5);
        opacity: 1;

        &.swiper-pagination-bullet-active {
          background: rgba(229, 238, 255, 1);
          width: 30px;
          border-radius: 5px;
        }
      }
    }
  }
}
</style>
